FUNCTION get_next_line()

    DECLARE STATIC MAIN_BUF;
    DECLARE TEMP_BUF;

    // HEAD is the starting position for appending data in MAIN_BUF
    DECLARE HEAD;
    // TAIL is the last position in MAIN_BUF where data is stored
    DECLARE TAIL;

    WHILE TRUE

        // Process any complete lines already in MAIN_BUF
        WHILE LINE EXISTS IN MAIN_BUF FROM TAIL TO HEAD
            GET_LINE(MAIN_BUF, TAIL)
            // Update TAIL after extracting the line
            UPDATE TAIL TO NEXT POSITION
        ENDWHILE

        // Reassign HEAD and TAIL if necessary to wrap-around
        REASSIGN HEAD AND TAIL AS NEEDED

        // Attempt to read new data into TEMP_BUF
        CALL READ() INTO TEMP_BUF

        IF READ SUCCESSFUL
            APPEND DATA FROM TEMP_BUF TO MAIN_BUF AT HEAD
            // Update HEAD after appending
            UPDATE HEAD BASED ON AMOUNT OF DATA READ
        ELSE
            RETURN FALSE, EXIT LOOP
        ENDIF

    ENDWHILE

    // Clean up or reset MAIN_BUF if needed
    CLEAN MAIN_BUF

    // Return NULL to indicate end of file
    RETURN NULL

END FUNCTION
